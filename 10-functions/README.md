# 10-functions

Contains an example of using functions in a containerized Ollama language model.

## Libraries Involved

- `github.com/testcontainers/testcontainers-go`: [Testcontainers for Golang](https://github.com/testcontainers/testcontainers-go) is library for running Docker containers for integration tests.
- `github.com/testcontainers/testcontainers-go/modules/ollama`: A module for running Ollama language models using Testcontainers.
- `github.com/tmc/langchaingo`: A library for interacting with language models.
- `github.com/tmc/langchaingo/llms/ollama`: A specific implementation of the language model interface for Ollama.

## Code Explanation

The code in `main.go` sets up and runs a containerized Ollama language model using Testcontainers, then uses the model to generate text based on a given prompt, functions and a system prompt that enables the use of the functions.

This example has been inspired by https://github.com/tmc/langchaingo/tree/main/examples/ollama-functions-example.

### Main Functions

- `main()`: The entry point of the application. It calls the `run()` function and logs any errors.
- `run()`: The main logic of the application. It performs the following steps:
  1. Runs an Ollama container using Testcontainers. The image used is `mdelapenya/llama3.2:0.5.4-3b`, loading the `llama3.2:3b` model.
  2. Retrieves the connection string for the running container.
  3. Creates a new Ollama language model instance.
  4. Defines the content to be generated by the language model, using a strict system prompt to use the tools.
  5. Defines a `finalResponse` function that formats the response from the LLM into a string. This tool is the last one to be called.
  6. Defines a `pokeapi` tool that finds information about a pokemon using PokeAPI (https://pokeapi.co/). This tool is used by the LLM to find information about a pokemon.
  7. Evaluates the response from the LLM, detecting if the tools are used, and calling them if needed.
  8. Generates the content and prints it to the console.

## Running the Example

To run the example, navigate to the `10-functions` directory and run the following command:

```sh
go run -v ./...
```

The application will start a containerized Ollama language model and generate text based on the provided prompt and tools. The generated text will be displayed in the console.

```shell
github.com/mdelapenya/genai-testcontainers-go/functions
2025/01/09 14:28:15 Question: Which pokemon has more moves, Haunter or Gengar?
2025/01/09 14:28:20 Final response: Gengar has more moves than Haunter. Gengar has 124 moves, while Haunter has 99 moves.
```
